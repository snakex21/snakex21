<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake - Hub</title>
    <style>
        :root {
            --bg: #ffffff;
            --text: #1a1a1a;
            --header-bg: #ffffff;
            --nav-text: #666;
            --nav-hover: #000;
            --border: #e0e0e0;
            --canvas-border: #ccc;
            --canvas-shadow: rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --bg: #121212;
            --text: #ffffff;
            --header-bg: #1a1a1a;
            --nav-text: #aaa;
            --nav-hover: #fff;
            --border: #333;
            --canvas-border: #333;
            --canvas-shadow: rgba(0, 255, 0, 0.1);
        }

        body { background-color: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; height: 100vh; margin: 0; overflow: hidden; transition: background 0.3s, color 0.3s; }
        
        /* HEADER */
        header { background: var(--header-bg); border-bottom: 1px solid var(--border); width: 100%; z-index: 100; transition: background 0.3s, border 0.3s; }
        nav { max-width: 1200px; margin: 0 auto; padding: 1rem 2rem; display: flex; align-items: center; gap: 2rem; }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--text); text-decoration: none; }
        .nav-links { display: flex; gap: 2rem; flex: 1; }
        .nav-links a { color: var(--nav-text); text-decoration: none; transition: 0.2s; font-size: 1rem; }
        .nav-links a:hover, .nav-links a.active { color: var(--nav-hover); }
        
        #theme-toggle { background: none; border: none; font-size: 1.2rem; cursor: pointer; padding: 0.5rem; }

        @media (max-width: 768px) { .nav-links { display: none; } }

        .game-wrapper { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        .score-board { display: flex; gap: 20px; margin-bottom: 15px; font-size: 1.2rem; }
        canvas { background-color: #1e1e1e; border: 2px solid var(--canvas-border); box-shadow: 0 0 20px var(--canvas-shadow); }
        
        .controls { margin-top: 20px; display: none; gap: 10px; }
        @media (max-width: 768px) {
            .controls { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
            .btn { padding: 15px; background: #333; border: none; color: white; border-radius: 8px; font-size: 1.5rem; }
            .btn:active { background: #1db954; }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="../../index.html" class="logo">Hub</a>
            <div class="nav-links">
                <a href="../gry.html" class="active">Gry</a>
                <a href="../../muzyka/muzyka.html">Muzyka</a>
                <a href="../../filmy/filmy glowna.html">Filmy</a>
                <a href="../../Programy/programy.html">Narzƒôdzia</a>
            </div>
            <button id="theme-toggle">üåô</button>
        </nav>
    </header>

    <div class="game-wrapper">
        <div class="score-board">
            <span>Wynik: <span id="score">0</span></span>
            <span>Rekord: <span id="high-score">0</span></span>
        </div>
        
        <canvas id="gameCanvas" width="400" height="400"></canvas>

        <div class="controls">
            <div></div>
            <button class="btn" onclick="changeDirection({keyCode: 38})">‚¨ÜÔ∏è</button>
            <div></div>
            <button class="btn" onclick="changeDirection({keyCode: 37})">‚¨ÖÔ∏è</button>
            <button class="btn" onclick="changeDirection({keyCode: 40})">‚¨áÔ∏è</button>
            <button class="btn" onclick="changeDirection({keyCode: 39})">‚û°Ô∏è</button>
        </div>
    </div>

    <script>
        // Theme Logic
        const html = document.documentElement;
        const themeBtn = document.getElementById('theme-toggle');
        const savedTheme = localStorage.getItem('theme') || 'dark';
        html.setAttribute('data-theme', savedTheme);
        themeBtn.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

        themeBtn.addEventListener('click', () => {
            const current = html.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            themeBtn.textContent = next === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        });

        // Game Logic
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('high-score');
        const gridSize = 20;
        const tileCount = canvas.width / gridSize;
        let speed = 7;
        let score = 0;
        let highScore = localStorage.getItem('snake_highscore') || 0;
        highScoreElement.textContent = highScore;
        let velocityX = 0;
        let velocityY = 0;
        let snake = [{x: 10, y: 10}];
        let food = {x: 15, y: 15};
        let gameInterval;
        let isGameRunning = false;

        function startGame() {
            if(isGameRunning) return;
            isGameRunning = true;
            velocityX = 1; velocityY = 0;
            gameInterval = setInterval(update, 1000 / speed);
        }

        function update() {
            const head = { x: snake[0].x + velocityX, y: snake[0].y + velocityY };
            if (head.x < 0) head.x = tileCount - 1;
            if (head.x >= tileCount) head.x = 0;
            if (head.y < 0) head.y = tileCount - 1;
            if (head.y >= tileCount) head.y = 0;

            for (let i = 0; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    resetGame(); return;
                }
            }

            snake.unshift(head);
            if (head.x === food.x && head.y === food.y) {
                score += 10; scoreElement.textContent = score;
                if (score > highScore) {
                    highScore = score; localStorage.setItem('snake_highscore', highScore); highScoreElement.textContent = highScore;
                }
                if(score % 50 === 0) { clearInterval(gameInterval); speed++; gameInterval = setInterval(update, 1000 / speed); }
                placeFood();
            } else { snake.pop(); }
            draw();
        }

        function draw() {
            ctx.fillStyle = '#1e1e1e'; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#1db954';
            snake.forEach((part, index) => {
                if(index === 0) ctx.fillStyle = '#1ed760'; else ctx.fillStyle = '#1db954';
                ctx.fillRect(part.x * gridSize, part.y * gridSize, gridSize - 2, gridSize - 2);
            });
            ctx.fillStyle = '#ff5555'; ctx.beginPath();
            ctx.arc((food.x * gridSize) + gridSize/2, (food.y * gridSize) + gridSize/2, gridSize/2 - 2, 0, 2 * Math.PI); ctx.fill();
        }

        function placeFood() {
            food.x = Math.floor(Math.random() * tileCount);
            food.y = Math.floor(Math.random() * tileCount);
            snake.forEach(part => { if(part.x === food.x && part.y === food.y) placeFood(); });
        }

        function resetGame() {
            clearInterval(gameInterval); isGameRunning = false;
            alert(`Koniec gry! Tw√≥j wynik: ${score}`);
            snake = [{x: 10, y: 10}]; score = 0; speed = 7;
            scoreElement.textContent = score; placeFood(); draw();
        }

        function changeDirection(event) {
            if(!isGameRunning) startGame();
            const left = 37, up = 38, right = 39, down = 40;
            const keyPressed = event.keyCode;
            const goingUp = velocityY === -1, goingDown = velocityY === 1;
            const goingRight = velocityX === 1, goingLeft = velocityX === -1;

            if (keyPressed === left && !goingRight) { velocityX = -1; velocityY = 0; }
            if (keyPressed === up && !goingDown) { velocityX = 0; velocityY = -1; }
            if (keyPressed === right && !goingLeft) { velocityX = 1; velocityY = 0; }
            if (keyPressed === down && !goingUp) { velocityX = 0; velocityY = 1; }
        }

        document.addEventListener('keydown', changeDirection);
        draw();
    </script>
</body>
</html>