<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Planer zada≈Ñ ‚Äì Max Playground</title>
    <meta name="description" content="Organizuj zadania, ≈õled≈∫ priorytety i monitoruj postƒôpy. Lekki planer zada≈Ñ, kt√≥ry zapisuje listy w pamiƒôci przeglƒÖdarki." />
    <link rel="icon" type="image/x-icon" href="https://www.solojuve.com/spolecznosc/zdj%C4%99cia/306-bezimienny-jpg/pobierz" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css" />
    <link rel="stylesheet" href="../../assets/css/site.css" />
    <style>
        :root {
            color-scheme: light dark;
        }

        body {
            background: radial-gradient(circle at 15% 20%, rgba(129, 140, 248, 0.22), transparent 55%),
                radial-gradient(circle at 80% 0%, rgba(244, 114, 182, 0.18), transparent 60%),
                var(--surface-page, #0f172a);
        }

        .planner-layout {
            display: grid;
            gap: 2.25rem;
            grid-template-columns: minmax(0, 3.5fr) minmax(0, 2fr);
            align-items: start;
        }

        @media (max-width: 1024px) {
            .planner-layout {
                grid-template-columns: 1fr;
            }
        }

        .planner-panel,
        .planner-sidebar {
            background: rgba(15, 23, 42, 0.88);
            border-radius: 28px;
            border: 1px solid rgba(148, 163, 184, 0.25);
            padding: clamp(1.5rem, 2vw + 1.25rem, 2.75rem);
            backdrop-filter: blur(18px);
            box-shadow: 0 26px 60px -38px rgba(15, 23, 42, 0.85);
        }

        .planner-header {
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        .planner-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }

        .planner-stat {
            padding: 1rem 1.25rem;
            border-radius: 20px;
            background: rgba(79, 70, 229, 0.15);
            border: 1px solid rgba(129, 140, 248, 0.3);
        }

        .planner-stat span {
            display: block;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: rgba(196, 203, 232, 0.8);
        }

        .planner-stat strong {
            display: block;
            margin-top: 0.35rem;
            font-size: 1.75rem;
            color: #fff;
        }

        .planner-form {
            display: grid;
            gap: 1rem;
        }

        .planner-form-group {
            display: grid;
            gap: 0.5rem;
        }

        .planner-form-group label {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            font-weight: 600;
            color: rgba(226, 232, 240, 0.8);
        }

        .planner-form-group input,
        .planner-form-group textarea,
        .planner-form-group select {
            border-radius: 18px;
            border: 1px solid rgba(148, 163, 184, 0.35);
            background: rgba(15, 23, 42, 0.65);
            color: #e2e8f0;
            padding: 0.85rem 1rem;
            font-size: 1rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .planner-form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .planner-form-group input:focus,
        .planner-form-group textarea:focus,
        .planner-form-group select:focus {
            border-color: rgba(244, 114, 182, 0.6);
            box-shadow: 0 0 0 3px rgba(244, 114, 182, 0.25);
            outline: none;
        }

        .planner-form-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            align-items: center;
            justify-content: flex-end;
        }

        .planner-button {
            border: none;
            border-radius: 999px;
            padding: 0.9rem 1.8rem;
            font-weight: 600;
            letter-spacing: 0.03em;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .planner-button.primary {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: #fff;
            box-shadow: 0 18px 38px -24px rgba(99, 102, 241, 0.95);
        }

        .planner-button.secondary {
            background: rgba(148, 163, 184, 0.18);
            color: rgba(226, 232, 240, 0.88);
            border: 1px solid rgba(148, 163, 184, 0.3);
        }

        .planner-button:focus-visible,
        .planner-button:hover {
            transform: translateY(-1px);
        }

        .task-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            align-items: center;
            margin: 1.5rem 0 1rem;
        }

        .filter-chip {
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.35);
            padding: 0.5rem 1rem;
            background: rgba(15, 23, 42, 0.6);
            color: rgba(226, 232, 240, 0.85);
            font-size: 0.85rem;
            letter-spacing: 0.04em;
            text-transform: uppercase;
            cursor: pointer;
            transition: background 0.2s ease, border-color 0.2s ease;
        }

        .filter-chip.is-active {
            background: rgba(129, 140, 248, 0.2);
            border-color: rgba(129, 140, 248, 0.6);
            color: #fff;
        }

        .task-search {
            flex: 1 1 200px;
            position: relative;
        }

        .task-search input {
            width: 100%;
            padding: 0.65rem 1rem 0.65rem 2.4rem;
            border-radius: 18px;
            border: 1px solid rgba(148, 163, 184, 0.35);
            background: rgba(15, 23, 42, 0.6);
            color: #e2e8f0;
        }

        .task-search span {
            position: absolute;
            left: 0.85rem;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(148, 163, 184, 0.75);
        }

        .task-list {
            display: grid;
            gap: 0.75rem;
        }

        .task-card {
            border-radius: 20px;
            border: 1px solid rgba(148, 163, 184, 0.25);
            background: rgba(15, 23, 42, 0.65);
            padding: 1rem 1.25rem;
            display: grid;
            gap: 0.5rem;
            transition: border-color 0.2s ease, transform 0.2s ease;
        }

        .task-card:hover {
            border-color: rgba(129, 140, 248, 0.45);
            transform: translateY(-1px);
        }

        .task-card[data-status="done"] {
            border-color: rgba(34, 197, 94, 0.45);
            background: rgba(22, 163, 74, 0.12);
        }

        .task-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .task-card h3 {
            font-size: 1.1rem;
            color: #fff;
            line-height: 1.4;
        }

        .task-card h3 span {
            font-size: 0.75rem;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            border-radius: 999px;
            padding: 0.2rem 0.7rem;
            margin-left: 0.45rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            background: rgba(244, 114, 182, 0.18);
            color: rgba(250, 232, 255, 0.9);
        }

        .task-actions {
            display: flex;
            gap: 0.4rem;
            align-items: center;
        }

        .task-actions button {
            border: none;
            border-radius: 12px;
            padding: 0.45rem 0.7rem;
            font-size: 0.8rem;
            letter-spacing: 0.04em;
            text-transform: uppercase;
            cursor: pointer;
            background: rgba(148, 163, 184, 0.18);
            color: rgba(226, 232, 240, 0.85);
            border: 1px solid transparent;
            transition: background 0.2s ease, border-color 0.2s ease;
        }

        .task-actions button:hover {
            background: rgba(244, 114, 182, 0.2);
            border-color: rgba(244, 114, 182, 0.45);
        }

        .task-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            font-size: 0.85rem;
            color: rgba(226, 232, 240, 0.75);
        }

        .task-meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            background: rgba(148, 163, 184, 0.16);
        }

        .task-notes {
            font-size: 0.95rem;
            line-height: 1.6;
            color: rgba(226, 232, 240, 0.82);
        }

        .task-empty {
            border-radius: 18px;
            border: 1px dashed rgba(148, 163, 184, 0.4);
            padding: 1.75rem;
            text-align: center;
            color: rgba(148, 163, 184, 0.8);
            font-size: 0.95rem;
        }

        .planner-sidebar h3 {
            font-size: 1.15rem;
            color: #f1f5f9;
            margin-bottom: 1rem;
        }

        .planner-sidebar p,
        .planner-sidebar li {
            color: rgba(226, 232, 240, 0.8);
            line-height: 1.6;
        }

        .planner-sidebar ul {
            padding-left: 1.1rem;
            display: grid;
            gap: 0.6rem;
        }

        .planner-timeline {
            display: grid;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .timeline-entry {
            border-radius: 16px;
            border: 1px solid rgba(148, 163, 184, 0.25);
            padding: 0.9rem 1rem;
            background: rgba(15, 23, 42, 0.55);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .timeline-entry strong {
            color: #fff;
            font-size: 0.95rem;
        }

        .timeline-entry span {
            color: rgba(148, 163, 184, 0.85);
            font-size: 0.85rem;
        }

        .planner-sidebar footer {
            margin-top: 2rem;
            font-size: 0.85rem;
            color: rgba(148, 163, 184, 0.75);
        }
    </style>
    <script defer src="../../assets/js/site.js"></script>
</head>
<body class="app-page app-page--dark" data-root="../../">
    <header class="site-header">
        <nav class="main-nav" aria-label="G≈Ç√≥wna nawigacja">
            <a class="nav-brand" href="../../index.html"><span>MX</span>Max Playground</a>
            <button class="nav-toggle" type="button" data-nav-toggle aria-expanded="false" aria-controls="primary-navigation">Menu</button>
            <div class="nav-menu" data-nav-menu id="primary-navigation">
                <a class="nav-link" href="../../index.html">Strona g≈Ç√≥wna</a>
                <div class="nav-item nav-item--dropdown">
                    <button class="nav-dropdown-toggle is-active" type="button" data-dropdown-toggle aria-haspopup="true" aria-expanded="false" aria-controls="nav-programy">Programy</button>
                    <div class="nav-dropdown" id="nav-programy" role="menu">
                        <a href="../programy.html">PrzeglƒÖd wszystkich program√≥w</a>
                        <a href="../generator kolorow/generator kolorow.html">Generator kolor√≥w</a>
                        <a href="../generator czcionek/generator czcionek.html">Generator czcionek</a>
                        <a href="../generator emoji/generator emoji.html">Generator emoji</a>
                        <a href="../konwerter jednostek/konwerter jednostek.html">Konwerter jednostek</a>
                        <a class="is-current" href="planer zadan.html">Planer zada≈Ñ</a>
                    </div>
                </div>
                <a class="nav-link" href="../../gry/gry.html">Gry</a>
                <a class="nav-link" href="../../filmy/filmy glowna.html">Filmy</a>
                <a class="nav-link" href="../../muzyka/muzyka.html">Muzyka</a>
                <a class="nav-link" href="../../zmiany.html">Dziennik zmian</a>
            </div>
            <div class="nav-actions">
                <button class="btn btn-ghost theme-toggle" type="button" data-theme-toggle aria-pressed="false">üåô Tryb nocny</button>
                <div class="header-clock">
                    <span class="clock-time" data-clock-time>--:--:--</span>
                    <span class="clock-date" data-clock-date>≈Åadowanie‚Ä¶</span>
                </div>
            </div>
        </nav>
    </header>
    <main class="standalone-app standalone-app--dark">
        <section class="app-hero">
            <div class="app-hero__content">
                <span class="badge">Organizacja</span>
                <h1>Planer zada≈Ñ</h1>
                <p>Dodawaj zadania, ustawiaj priorytety, ≈õled≈∫ terminy i zaznaczaj zako≈Ñczone dzia≈Çania. Wszystko zapisuje siƒô lokalnie, wiƒôc nawet po od≈õwie≈ºeniu niczego nie stracisz.</p>
            </div>
            <div class="app-hero__actions">
                <a class="btn btn-secondary" href="../programy.html">‚Üê Wr√≥ƒá do listy program√≥w</a>
            </div>
        </section>
        <div class="standalone-app__inner planner-layout">
            <section class="planner-panel" aria-label="Panel zada≈Ñ">
                <header class="planner-header">
                    <div>
                        <h2>Twoja tablica</h2>
                        <p>Dodaj zadanie poni≈ºej. Mo≈ºesz filtrowaƒá listƒô po statusie, kategorii oraz wyszukiwaƒá po nazwie i notatkach.</p>
                    </div>
                    <div class="planner-stats" data-planner-stats>
                        <article class="planner-stat">
                            <span>≈ÅƒÖcznie</span>
                            <strong data-stat-total>0</strong>
                        </article>
                        <article class="planner-stat">
                            <span>Aktywne</span>
                            <strong data-stat-active>0</strong>
                        </article>
                        <article class="planner-stat">
                            <span>Zako≈Ñczone</span>
                            <strong data-stat-done>0</strong>
                        </article>
                        <article class="planner-stat">
                            <span>Na dzi≈õ</span>
                            <strong data-stat-today>0</strong>
                        </article>
                    </div>
                </header>
                <form class="planner-form" data-planner-form autocomplete="off">
                    <div class="planner-form-group">
                        <label for="task-title">Tytu≈Ç zadania</label>
                        <input id="task-title" name="title" type="text" placeholder="Np. przygotuj prezentacjƒô" required maxlength="80" />
                    </div>
                    <div class="planner-form-group">
                        <label for="task-category">Kategoria</label>
                        <select id="task-category" name="category"></select>
                    </div>
                    <div class="planner-form-group">
                        <label for="task-priority">Priorytet</label>
                        <select id="task-priority" name="priority">
                            <option value="low">Niski</option>
                            <option value="medium" selected>≈öredni</option>
                            <option value="high">Wysoki</option>
                        </select>
                    </div>
                    <div class="planner-form-group">
                        <label for="task-due">Termin</label>
                        <input id="task-due" name="due" type="date" />
                    </div>
                    <div class="planner-form-group">
                        <label for="task-notes">Notatki</label>
                        <textarea id="task-notes" name="notes" placeholder="Dodaj szczeg√≥≈Çy, linki, checklisty‚Ä¶"></textarea>
                    </div>
                    <div class="planner-form-actions">
                        <button class="planner-button secondary" type="reset">Wyczy≈õƒá</button>
                        <button class="planner-button primary" type="submit">
                            <span aria-hidden="true">‚ûï</span>
                            <span>Dodaj zadanie</span>
                        </button>
                    </div>
                </form>

                <div class="task-toolbar">
                    <div class="task-search">
                        <span aria-hidden="true">üîç</span>
                        <label class="sr-only" for="task-search">Szukaj zada≈Ñ</label>
                        <input id="task-search" type="search" placeholder="Szukaj po tytule lub notatkach‚Ä¶" data-task-search />
                    </div>
                    <div class="task-filters" data-task-filters>
                        <button class="filter-chip is-active" type="button" data-filter-status="all">Wszystkie</button>
                        <button class="filter-chip" type="button" data-filter-status="active">Aktywne</button>
                        <button class="filter-chip" type="button" data-filter-status="done">Zako≈Ñczone</button>
                    </div>
                    <div class="task-filters" data-task-category-filter></div>
                </div>

                <section class="task-list" data-task-list aria-live="polite"></section>
            </section>
            <aside class="planner-sidebar" aria-label="Wskaz√≥wki organizacyjne">
                <h3>Jak wykorzystaƒá planer?</h3>
                <ul>
                    <li>Dodawaj szczeg√≥≈Çy w notatkach ‚Äì mo≈ºesz tu wkleiƒá linki do dokument√≥w lub checklisty w formie kr√≥tkich punkt√≥w.</li>
                    <li>Priorytety wyr√≥≈ºniajƒÖ zadania kolorami, dziƒôki czemu szybciej zauwa≈ºysz, co wymaga uwagi.</li>
                    <li>Filtry kategorii pozwalajƒÖ przeglƒÖdaƒá zadania zwiƒÖzane z pracƒÖ, naukƒÖ czy zdrowiem bez prze≈ÇƒÖczania widoku.</li>
                </ul>
                <div class="planner-timeline" data-planner-timeline></div>
                <footer>
                    Twoje zadania sƒÖ przechowywane lokalnie w przeglƒÖdarce. Mo≈ºesz bez obaw zamknƒÖƒá kartƒô ‚Äì wszystko bƒôdzie na Ciebie czekaƒá przy nastƒôpnej wizycie.
                </footer>
            </aside>
        </div>
    </main>
    <footer>
        <p>Copyright ¬© 2024 Max ¬∑ Projekt tworzony z pasjƒÖ i odrobinƒÖ magii CSS.</p>
    </footer>
    <script>
        (function () {
            const storageKey = 'mx-planner-tasks-v1';
            const categories = [
                { id: 'work', label: 'Praca i projekty', icon: 'üíº' },
                { id: 'study', label: 'Nauka i rozw√≥j', icon: 'üìö' },
                { id: 'health', label: 'Zdrowie i forma', icon: 'üí™' },
                { id: 'home', label: 'Dom i rodzina', icon: 'üè†' },
                { id: 'ideas', label: 'Pomys≈Çy i inspiracje', icon: '‚ú®' }
            ];

            const priorityConfig = {
                low: { label: 'Niski', badge: 'üåø', className: 'priority-low' },
                medium: { label: '≈öredni', badge: 'üî•', className: 'priority-medium' },
                high: { label: 'Wysoki', badge: 'üöÄ', className: 'priority-high' }
            };

            const form = document.querySelector('[data-planner-form]');
            const titleInput = form?.querySelector('#task-title');
            const categorySelect = form?.querySelector('#task-category');
            const prioritySelect = form?.querySelector('#task-priority');
            const dueInput = form?.querySelector('#task-due');
            const notesInput = form?.querySelector('#task-notes');
            const taskList = document.querySelector('[data-task-list]');
            const statusFilters = document.querySelectorAll('[data-filter-status]');
            const categoryFilterContainer = document.querySelector('[data-task-category-filter]');
            const searchInput = document.querySelector('[data-task-search]');
            const statTotal = document.querySelector('[data-stat-total]');
            const statActive = document.querySelector('[data-stat-active]');
            const statDone = document.querySelector('[data-stat-done]');
            const statToday = document.querySelector('[data-stat-today]');
            const timelineContainer = document.querySelector('[data-planner-timeline]');

            let tasks = [];
            let activeStatus = 'all';
            let activeCategory = 'all';
            let searchQuery = '';

            const generateId = () => `task-${Math.random().toString(36).slice(2)}-${Date.now()}`;

            const loadTasks = () => {
                try {
                    const stored = localStorage.getItem(storageKey);
                    if (!stored) return [];
                    const parsed = JSON.parse(stored);
                    return Array.isArray(parsed) ? parsed : [];
                } catch (error) {
                    console.error('Nie uda≈Ço siƒô wczytaƒá zada≈Ñ', error);
                    return [];
                }
            };

            const saveTasks = () => {
                try {
                    localStorage.setItem(storageKey, JSON.stringify(tasks));
                } catch (error) {
                    console.error('Nie uda≈Ço siƒô zapisaƒá zada≈Ñ', error);
                }
            };

            const ensureInitialTasks = () => {
                if (tasks.length) return;
                tasks = [
                    {
                        id: generateId(),
                        title: 'Zaplanuj zadania na tydzie≈Ñ',
                        category: 'work',
                        priority: 'medium',
                        due: new Date().toISOString().slice(0, 10),
                        notes: 'Zapisz 3 najwa≈ºniejsze cele i podziel je na kroki.',
                        completed: false,
                        createdAt: Date.now()
                    },
                    {
                        id: generateId(),
                        title: '30 minut nauki jƒôzyka',
                        category: 'study',
                        priority: 'high',
                        due: '',
                        notes: 'Powt√≥rka s≈Ç√≥wek i rozmowa na g≈Ços.',
                        completed: false,
                        createdAt: Date.now()
                    },
                    {
                        id: generateId(),
                        title: 'Trening cardio',
                        category: 'health',
                        priority: 'medium',
                        due: '',
                        notes: 'Co najmniej 20 minut, najlepiej na ≈õwie≈ºym powietrzu.',
                        completed: false,
                        createdAt: Date.now()
                    }
                ];
            };

            const populateCategorySelect = () => {
                if (!categorySelect) return;
                categories.forEach((category) => {
                    const option = document.createElement('option');
                    option.value = category.id;
                    option.textContent = `${category.icon} ${category.label}`;
                    categorySelect.appendChild(option);
                });
            };

            const renderCategoryFilters = () => {
                if (!categoryFilterContainer) return;
                categoryFilterContainer.innerHTML = '';
                const createButton = (category) => {
                    const button = document.createElement('button');
                    button.type = 'button';
                    button.className = `filter-chip${activeCategory === category.id ? ' is-active' : ''}`;
                    button.dataset.filterCategory = category.id;
                    button.textContent = category.id === 'all' ? 'Wszystkie kategorie' : `${category.icon} ${category.label}`;
                    button.addEventListener('click', () => {
                        activeCategory = category.id;
                        renderCategoryFilters();
                        renderTasks();
                    });
                    return button;
                };
                categoryFilterContainer.appendChild(createButton({ id: 'all', label: 'Wszystko', icon: 'üóÇÔ∏è' }));
                categories.forEach((category) => {
                    categoryFilterContainer.appendChild(createButton(category));
                });
            };

            const matchesStatus = (task) => {
                if (activeStatus === 'all') return true;
                if (activeStatus === 'active') return !task.completed;
                if (activeStatus === 'done') return task.completed;
                return true;
            };

            const matchesCategory = (task) => {
                if (activeCategory === 'all') return true;
                return task.category === activeCategory;
            };

            const matchesSearch = (task) => {
                if (!searchQuery) return true;
                const needle = searchQuery.toLowerCase();
                return (
                    task.title.toLowerCase().includes(needle) ||
                    (task.notes ?? '').toLowerCase().includes(needle)
                );
            };

            const getPriorityBadge = (task) => {
                const config = priorityConfig[task.priority] ?? priorityConfig.medium;
                return `${config.badge} ${config.label}`;
            };

            const describeDueDate = (due) => {
                if (!due) return 'Brak terminu';
                const dueDate = new Date(due);
                if (Number.isNaN(dueDate.getTime())) return 'Brak terminu';
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const diff = (dueDate - today) / (1000 * 60 * 60 * 24);
                if (diff === 0) return 'Termin: dzi≈õ';
                if (diff === 1) return 'Termin: jutro';
                if (diff < 0) return `Po terminie: ${Math.abs(Math.round(diff))} dni temu`;
                return `Termin za ${Math.round(diff)} dni`;
            };

            const renderTasks = () => {
                if (!taskList) return;
                taskList.innerHTML = '';
                const filtered = tasks.filter((task) => matchesStatus(task) && matchesCategory(task) && matchesSearch(task));

                if (!filtered.length) {
                    const empty = document.createElement('div');
                    empty.className = 'task-empty';
                    empty.textContent = 'Brak zada≈Ñ spe≈ÇniajƒÖcych kryteria. Dodaj nowe lub zmie≈Ñ filtr.';
                    taskList.appendChild(empty);
                    return;
                }

                filtered
                    .sort((a, b) => {
                        if (a.completed !== b.completed) {
                            return a.completed ? 1 : -1;
                        }
                        return (b.createdAt ?? 0) - (a.createdAt ?? 0);
                    })
                    .forEach((task) => {
                        const card = document.createElement('article');
                        card.className = 'task-card';
                        card.dataset.status = task.completed ? 'done' : 'active';

                        const header = document.createElement('div');
                        header.className = 'task-card-header';

                        const title = document.createElement('h3');
                        title.textContent = task.title;
                        const priorityBadge = document.createElement('span');
                        priorityBadge.textContent = getPriorityBadge(task);
                        title.appendChild(priorityBadge);

                        const actions = document.createElement('div');
                        actions.className = 'task-actions';

                        const toggleButton = document.createElement('button');
                        toggleButton.type = 'button';
                        toggleButton.textContent = task.completed ? 'Przywr√≥ƒá' : 'Zako≈Ñcz';
                        toggleButton.addEventListener('click', () => {
                            task.completed = !task.completed;
                            saveTasks();
                            renderTasks();
                            updateStats();
                            renderTimeline();
                        });

                        const deleteButton = document.createElement('button');
                        deleteButton.type = 'button';
                        deleteButton.textContent = 'Usu≈Ñ';
                        deleteButton.addEventListener('click', () => {
                            tasks = tasks.filter((candidate) => candidate.id !== task.id);
                            saveTasks();
                            renderTasks();
                            updateStats();
                            renderTimeline();
                        });

                        actions.append(toggleButton, deleteButton);
                        header.append(title, actions);
                        card.appendChild(header);

                        const meta = document.createElement('div');
                        meta.className = 'task-meta';
                        const categoryInfo = categories.find((item) => item.id === task.category);
                        const categoryBadge = document.createElement('span');
                        categoryBadge.textContent = categoryInfo ? `${categoryInfo.icon} ${categoryInfo.label}` : 'Inne';
                        const dueBadge = document.createElement('span');
                        dueBadge.textContent = describeDueDate(task.due);
                        meta.append(categoryBadge, dueBadge);

                        const createdBadge = document.createElement('span');
                        createdBadge.textContent = `Dodano: ${new Intl.DateTimeFormat('pl-PL', {
                            day: '2-digit',
                            month: 'long'
                        }).format(new Date(task.createdAt ?? Date.now()))}`;
                        meta.appendChild(createdBadge);

                        card.appendChild(meta);

                        if (task.notes) {
                            const notes = document.createElement('p');
                            notes.className = 'task-notes';
                            notes.textContent = task.notes;
                            card.appendChild(notes);
                        }

                        taskList.appendChild(card);
                    });
            };

            const updateStats = () => {
                const total = tasks.length;
                const done = tasks.filter((task) => task.completed).length;
                const active = total - done;
                const today = tasks.filter((task) => {
                    if (!task.due) return false;
                    const dueDate = new Date(task.due);
                    const now = new Date();
                    return (
                        dueDate.getFullYear() === now.getFullYear() &&
                        dueDate.getMonth() === now.getMonth() &&
                        dueDate.getDate() === now.getDate()
                    );
                }).length;

                statTotal && (statTotal.textContent = total.toString());
                statActive && (statActive.textContent = active.toString());
                statDone && (statDone.textContent = done.toString());
                statToday && (statToday.textContent = today.toString());
            };

            const renderTimeline = () => {
                if (!timelineContainer) return;
                timelineContainer.innerHTML = '';
                if (!tasks.length) return;

                const upcoming = tasks
                    .filter((task) => task.due)
                    .map((task) => ({
                        ...task,
                        dueDate: new Date(task.due)
                    }))
                    .filter((task) => !Number.isNaN(task.dueDate.getTime()))
                    .sort((a, b) => a.dueDate - b.dueDate)
                    .slice(0, 4);

                upcoming.forEach((task) => {
                    const entry = document.createElement('div');
                    entry.className = 'timeline-entry';
                    const title = document.createElement('strong');
                    title.textContent = task.title;
                    const date = document.createElement('span');
                    date.textContent = new Intl.DateTimeFormat('pl-PL', {
                        day: '2-digit',
                        month: 'long'
                    }).format(task.dueDate);
                    entry.append(title, date);
                    timelineContainer.appendChild(entry);
                });

                if (!upcoming.length) {
                    const placeholder = document.createElement('p');
                    placeholder.textContent = 'Brak zaplanowanych termin√≥w. Dodaj datƒô w wybranych zadaniach, aby zobaczyƒá je tutaj.';
                    placeholder.style.color = 'rgba(226, 232, 240, 0.75)';
                    timelineContainer.appendChild(placeholder);
                }
            };

            const handleSubmit = (event) => {
                event.preventDefault();
                if (!form || !titleInput) return;
                const formData = new FormData(form);
                const title = (formData.get('title') ?? '').toString().trim();
                if (!title) {
                    titleInput.focus();
                    return;
                }
                const task = {
                    id: generateId(),
                    title,
                    category: (formData.get('category') ?? categories[0].id).toString(),
                    priority: (formData.get('priority') ?? 'medium').toString(),
                    due: (formData.get('due') ?? '').toString(),
                    notes: (formData.get('notes') ?? '').toString().trim(),
                    completed: false,
                    createdAt: Date.now()
                };
                tasks.unshift(task);
                saveTasks();
                renderTasks();
                updateStats();
                renderTimeline();
                form.reset();
                titleInput.focus();
            };

            const attachEventListeners = () => {
                form?.addEventListener('submit', handleSubmit);

                statusFilters.forEach((button) => {
                    button.addEventListener('click', () => {
                        statusFilters.forEach((other) => other.classList.remove('is-active'));
                        button.classList.add('is-active');
                        activeStatus = button.dataset.filterStatus ?? 'all';
                        renderTasks();
                    });
                });

                searchInput?.addEventListener('input', (event) => {
                    if (!(event.target instanceof HTMLInputElement)) return;
                    searchQuery = event.target.value.trim();
                    renderTasks();
                });

                window.addEventListener('beforeunload', () => {
                    saveTasks();
                });
            };

            const init = () => {
                populateCategorySelect();
                renderCategoryFilters();
                tasks = loadTasks();
                ensureInitialTasks();
                renderTasks();
                updateStats();
                renderTimeline();
                attachEventListeners();
            };

            init();
        })();
    </script>
</body>
</html>
